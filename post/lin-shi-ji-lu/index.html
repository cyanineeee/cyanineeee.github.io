<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>djangoå­¦ä¹  -- å¯ä»¥æ„Ÿå—åˆ°æœ€åŸå§‹çš„djangoæ¡†æ¶æ˜¯å‰åç«¯ä¸åˆ†ç¦»çš„ -- part.1 | cyanine</title>
<link rel="shortcut icon" href="http://localhost:4000/favicon.ico?v=1723632390821">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="http://localhost:4000/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="djangoå­¦ä¹  -- å¯ä»¥æ„Ÿå—åˆ°æœ€åŸå§‹çš„djangoæ¡†æ¶æ˜¯å‰åç«¯ä¸åˆ†ç¦»çš„ -- part.1 | cyanine - Atom Feed" href="http://localhost:4000/atom.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">



    <meta name="description" content="

å­¦ä¹ è§†é¢‘


1.è¯·æ±‚å’Œå“åº”

get post redirect

2.æ•°æ®åº“æ“ä½œ

mysql+pymsql
ORMæ¡†æ¶ -&gt; å¸®åŠ©æˆ‘ä»¬å¤„ç†sqlè¯­å¥ =&gt; pip install mysqlclient
åˆ›å»ºä¿®æ”¹åˆ é™¤æ•°..." />
    <meta name="keywords" content="" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
    <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.5.1/build/highlight.min.js"></script>
  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="http://localhost:4000">
  <img class="avatar" src="http://localhost:4000/images/avatar.png?v=1723632390821" alt="">
  </a>
  <h1 class="site-title">
    cyanine
  </h1>
  <p class="site-description">
    my personal blog
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          Home Page
        </a>
      
    
      
        <a href="/archives" class="menu">
          Archive
        </a>
      
    
      
        <a href="/tags" class="menu">
          Tags
        </a>
      
    
      
        <a href="/post/about" class="menu">
          About
        </a>
      
    
      
        <a href="http://localhost:4000/post/cczhi-zhen" class="menu">
          å‡‘æ•°
        </a>
      
    
  </div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              djangoå­¦ä¹  -- å¯ä»¥æ„Ÿå—åˆ°æœ€åŸå§‹çš„djangoæ¡†æ¶æ˜¯å‰åç«¯ä¸åˆ†ç¦»çš„ -- part.1
            </h2>
            <div class="post-info">
              <span>
                2023-06-27
              </span>
              <span>
                18 min read
              </span>
              
            </div>
            
            <div class="post-content-wrapper">
              <div class="post-content" v-pre>
                <ul>
<li>
<h2 id="å­¦ä¹ è§†é¢‘"><strong><a href="https://www.bilibili.com/video/BV1NL41157ph/?p=45&amp;spm_id_from=pageDriver&amp;vd_source=c66937bc5207a56bafe7811cb2b0c4da">å­¦ä¹ è§†é¢‘</a></strong></h2>
</li>
</ul>
<h3 id="1è¯·æ±‚å’Œå“åº”">1.è¯·æ±‚å’Œå“åº”</h3>
<ul>
<li>get post redirect</li>
</ul>
<h3 id="2æ•°æ®åº“æ“ä½œ">2.æ•°æ®åº“æ“ä½œ</h3>
<ul>
<li>mysql+pymsql</li>
<li>ORMæ¡†æ¶ -&gt; å¸®åŠ©æˆ‘ä»¬å¤„ç†sqlè¯­å¥ =&gt; pip install mysqlclient<br>
åˆ›å»ºä¿®æ”¹åˆ é™¤æ•°æ®ä¸­çš„è¡¨ï¼ˆä¸ç”¨å†™sqlè¯­å¥ï¼‰<br>
æ“ä½œè¡¨ä¸­çš„æ•°æ®<br>
=&gt; åˆ›å»ºæ•°æ®åº“ djangoè¿æ¥æ•°æ®<br>
PS. éœ€è¦åœ¨setting.pyè¿›è¡Œè®¾ç½®</li>
</ul>
<h3 id="3è®©djangoå¸®åŠ©åˆ›å»ºæ•°æ®åº“è¡¨">3.è®©djangoå¸®åŠ©åˆ›å»ºæ•°æ®åº“è¡¨</h3>
<ul>
<li>djangoä¼šé€šè¿‡modelä¸­çš„ç±»å¸®åŠ©ç”Ÿæˆsqlåˆ›å»ºè¡¨å’Œå­—æ®µ<br>
ç±»åä»£è¡¨è¡¨æ˜ å±æ€§ä»£è¡¨åˆ—å</li>
</ul>
<pre><code class="language-python">class UserInfo(models.Model):
    name = models.CharField(max_length=32)
    password = models.CharField(max_length=64)
</code></pre>
<h3 id="4æ‰§è¡Œå‘½ä»¤">4.æ‰§è¡Œå‘½ä»¤</h3>
<ul>
<li>éœ€è¦æå‰æ³¨å†Œapp -&gt; åœ¨setting.pyä¸­æ³¨å†Œ<br>
python manage.py makemigrations<br>
python manage.py migrate</li>
</ul>
<h3 id="5éœ€è¦æ³¨æ„">5.éœ€è¦æ³¨æ„</h3>
<ul>
<li>åœ¨å·²ç»æœ‰çš„modelç±»ä¸­æ·»åŠ å±æ€§ å¯èƒ½ä¼šå¯¼è‡´åŸæ¥å·²ç»æœ‰çš„æ•°æ®ç¼ºå¤±æ–°å¢åŠ çš„åˆ—çš„æ•°æ®<br>
djangoç»™å‡ºäº†ä¸¤ä¸ªé€‰æ‹©ï¼Œä¸€æ˜¯åœ¨å‘½ä»¤è¡Œä¸­é»˜è®¤æ·»åŠ è¾“å…¥ï¼ŒäºŒæ˜¯åœ¨æ–°å¢åŠ çš„å±æ€§å­—æ®µä¸­å¢åŠ  <code>default=</code>å­—æ®µï¼Œä»£è¡¨ç»™åŸæ¥æ²¡æœ‰çš„ç¼ºå¤±å€¼èµ‹å€¼ã€‚ä¾‹å¦‚ï¼š<br>
<code>age = models.CharField(defalut=18)</code><br>
æˆ–è€…è®¾ç½®å¯ä»¥ä¸ºç©º<br>
<code>age = models.CharField(null=True,blank=True)</code></li>
</ul>
<h3 id="6é€šè¿‡djangoå‘è¡¨ä¸­æ’å…¥æ•°æ®">6.é€šè¿‡djangoå‘è¡¨ä¸­æ’å…¥æ•°æ®</h3>
<ul>
<li>
<p><code>UserInfo.objects.create(name='cyanine',password=&quot;123456&quot;)</code> æ’å…¥æ•°æ® éœ€è¦ç±»ä¸­çš„å±æ€§å¯¹åº”<br>
<code>a = UserInfo.objects.all()</code>è·å–æ‰€æœ‰æ•°æ® ä»¥åˆ—è¡¨è¿”å›ï¼Œå…¶ä¸­æ¯ä¸€ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ é€šè¿‡<code>.å±æ€§</code>è·å–å…·ä½“çš„æ•°æ®<code>a.name</code>ï¼Œç»“åˆ<code>.filter()</code>å¯ä»¥è¿›è¡Œç­›é€‰æŸ¥è¯¢<br>
<code>.first()</code>è·å–è·å–åˆ°çš„ç¬¬ä¸€ä¸ªå¯¹è±¡</p>
</li>
<li>
<p>åˆ é™¤æ•°æ®<br>
<code>.delete()</code><br>
å¯ä»¥æ·»åŠ <code>filter</code>è¿›è¡Œç­›é€‰ ä¾‹å¦‚<code>UserInfo.objects.filter(name='cyanine').delete()</code> åˆ é™¤æ‰€æœ‰nameä¸ºcyanineçš„æ•°æ®<br>
ä½¿ç”¨<code>.all()</code>é€‰æ‹©å…¨éƒ¨<code>UserInfo.objects.all().delete()</code>åˆ é™¤è¿™å¼ è¡¨ä¸­çš„æ‰€æœ‰æ•°æ®</p>
</li>
<li>
<p>æ›´æ–°æ•°æ®<br>
<code>UserInfo.objects.all().updata(password=123456)</code>æ›´æ–°æ‰€æœ‰çš„passwordä¸º123456<br>
è¿˜å¯ä»¥ç»“åˆ<code>.filter()</code>è¿›è¡Œç­›é€‰</p>
</li>
</ul>
<h3 id="7djangoè¡¨å•å¦‚æœä¸å†™action-é‚£ä¹ˆé»˜è®¤æäº¤å°±æ˜¯å‘å½“å‰é¡µé¢å‘é€ä¸€ä¸ªpostè¯·æ±‚">7.djangoè¡¨å•å¦‚æœä¸å†™action é‚£ä¹ˆé»˜è®¤æäº¤å°±æ˜¯å‘å½“å‰é¡µé¢å‘é€ä¸€ä¸ªpostè¯·æ±‚</h3>
<h3 id="8djangoä¸­çš„urlå‘½åèƒ½é¿å…å¯¹urlçš„ç¡¬ç¼–ç ">8.djangoä¸­çš„urlå‘½åèƒ½é¿å…å¯¹urlçš„ç¡¬ç¼–ç ï¼Œ</h3>
<ul>
<li>ä¾‹å¦‚ä¿®æ”¹ä¸€ä¸ªurl çš„è·¯å¾„å¦‚æœä»¥å‰åœ¨htmlé‡‡ç”¨çš„æ˜¯ç¡¬ç¼–ç ï¼Œç›´æ¥å†™å¯¹åº”çš„ä¼šå¯¼è‡´åé¢ä¿®æ”¹ç»´æŠ¤æä¸ºå›°éš¾ã€‚<br>
ä½†æ˜¯å¦‚æœé‡‡ç”¨urlå‘½åç©ºé—´ï¼Œé‚£ä¹ˆä¿®æ”¹çš„urlå¹¶ä¸ä¼šç›´æ¥å½±å“åˆ°ï¼Œdjangoä¼šé€šè¿‡urlçš„å‘½åè®¿é—®åˆ°ï¼Œè€Œä¸æ˜¯ç¡¬ç¼–ç ã€‚<code>{% url 'url_name' other_param%}</code>  è¿™ä¸ªurl_name å°±æ˜¯åœ¨urls.pyæ–‡ä»¶ä¸­çš„<code>path('url/example', views.function,name = url_name)</code>çš„nameä¸ºurlä»çš„é‡å‘½åï¼Œè¿™æ ·ä¿®æ”¹pathå¯¹åº”çš„urlï¼Œå°±ä¸ç”¨åœ¨ç»´æŠ¤å‰ç«¯çš„é¡µé¢äº†ã€‚</li>
</ul>
<h3 id="9modelæ·»åŠ çº¦æŸ-æ•°æ®åº“çš„çº¦æŸ">9.modelæ·»åŠ çº¦æŸ (æ•°æ®åº“çš„çº¦æŸ)</h3>
<ul>
<li>ä¾‹å¦‚å‘˜å·¥è¡¨å’Œéƒ¨é—¨è¡¨ä¹‹é—´çš„å…³ç³»ï¼Œè®©å‘˜å·¥è¡¨å’Œéƒ¨é—¨è¡¨å…³è”ï¼Œé€šè¿‡<code>ForeignKry</code>æ–¹æ³•ä¸­çš„<code>to</code>å’Œ<code>to_field</code>å‚æ•°åœ¨djangoä¸­è®¾ç½®ã€‚ç”¨é€”æ˜¯å¯ä»¥æ–¹ä¾¿å¯¹è¾“å…¥æ•°æ®çš„åˆæ³•æ€§åˆ¤æ–­ï¼Œä¾‹å¦‚å‘˜å·¥ä¸èƒ½å±äºä¸€ä¸ªä¸å­˜åœ¨çš„éƒ¨é—¨ï¼Œå°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„è¿›è¡Œåˆ¤æ–­ã€‚</li>
<li>åœ¨å‘˜å·¥è¡¨ä¸­<br>
<code>department = models.ForeignKey(to = 'Department', to_field = 'id')</code><br>
è¿™å°±å°†å‘˜å·¥è¡¨å’Œéƒ¨é—¨è¡¨è¿›è¡Œäº†å…³è”ï¼Œå‘˜å·¥çš„éƒ¨é—¨åªèƒ½å±äºDepatmentä¸­çš„ä¸€ä¸ªï¼›<code>to</code>è¡¨ç¤ºå…³è”çš„è¡¨åï¼Œ<code>to_field</code>è¡¨æ˜å…³è”çš„è¡¨çš„ä¸€ä¸ªåˆ—åå­—æ®µã€‚è¦æ³¨æ„çš„æ˜¯ï¼Œdjangoåœ¨å‚¨å­˜è¿™æ ·çš„å­—æ®µæ—¶é»˜è®¤å‘½åæ–¹å¼æ˜¯<code>å…³è”è¡¨å_id</code>ï¼ˆä¾‹å¦‚è¿™ä¸ªå°±æ˜¯<code>depaetment_id</code>ï¼‰ã€‚<br>
äºæ­¤å¯¹åº”ï¼Œåœ¨è·å–çš„æ—¶å€™ï¼Œå¦‚æœç›´æ¥é€šè¿‡å­—æ®µ/å±æ€§è·å–çš„è¯ï¼Œä¾‹å¦‚<code>obj.è”è¡¨å_id</code>ï¼Œè·å–åˆ°çš„æ—¶å‚¨å­˜åœ¨è¿™å¼ è¡¨ä¸­çš„å¯¹åº”å…³è”è¡¨çš„æ•°å­—ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„å…·ä½“æŒ‡ä»£ï¼Œå› æ­¤djangoè§„å®šäº†å¦‚æœç›´æ¥<code>.è”è¡¨å</code>å°±å¯ä»¥è·å–åˆ°å…³è”è¡¨å¯¹åº”çš„é‚£ä¸€è¡Œæ•°æ®ï¼ˆå°è£…ä¸ºä¸€ä¸ªqueryobjå¯¹è±¡ï¼‰ï¼Œç„¶åå°±å¯ä»¥ç»§ç»­é€šè¿‡å…³è”è¡¨å†…çš„å±æ€§è¿›è¡ŒæŸ¥æ‰¾ã€‚ä¾‹å¦‚ï¼Œéƒ¨é—¨è¡¨ä¸­ä¸€å…±æœ‰ä¸¤ä¸ªéƒ¨é—¨ï¼Œå­—æ®µä¸ºï¼ˆid,éƒ¨é—¨åï¼‰ï¼Œå†…å®¹ä¸ºï¼ˆ1ï¼Œä¸»ç®¡éƒ¨ï¼‰ï¼ˆ2ï¼Œè¿è¡Œéƒ¨ï¼‰ï¼Œå‘˜å·¥è¡¨å…³è”</li>
<li>çº§è”åˆ é™¤ ç½®ç©ºnull<br>
ç°åœ¨è®¾æƒ³ä¸€ç§æƒ…å†µï¼Œå¦‚æœéƒ¨é—¨è¡¨ä¸­çš„ä¸€ä¸ªéƒ¨é—¨å–æ¶ˆæ‰ï¼Œé‚£ä¹ˆä¸ä¹‹å…³è”çš„å‘˜å·¥åº”è¯¥å¦‚ä½•å¤„ç†å‘¢ï¼Ÿå¸¸ç”¨çš„å°±æ˜¯ä¸¤ç§æ“ä½œï¼šå°†ä»–ä»¬ä¸€å¹¶åˆ é™¤ï¼ˆè¿™å°±æ˜¯çº§è”åˆ é™¤ï¼‰ï¼›è¿˜æœ‰ä¸€ç§å°±æ˜¯å°†ä»–ä»¬è®¾ç½®ä¸ºnullã€‚å¯¹åº”çš„è¿™ä¸¤ç§æ–¹å¼åœ¨djangoä¸­éœ€è¦è¿™æ ·è®¾ç½®ï¼š<br>
<code>department = models.ForeignKey(to = 'Department', to_field = 'id',on_delete=models.CASCADE)</code> çº§è”åˆ é™¤<br>
<code>department = models.ForeignKey(to = 'Department', to_field = 'id',null=True,blank=True,on_delete=models.SET_NULL)</code> ç½®ç©º  éœ€è¦æ³¨æ„çš„æ˜¯ ç½®ç©ºçš„å‰æå°±æ˜¯è¿™ä¸ªå­—æ®µå¯ä»¥ä¸ºç©º<code>null = True</code> è¿™äº›éƒ½æ˜¯djangoä¸­çš„æ“ä½œã€‚</li>
</ul>
<h3 id="10æ€§åˆ«å­˜å‚¨">10.æ€§åˆ«å­˜å‚¨</h3>
<ul>
<li>modelçš„choice ä¸æ•°æ®åº“æ— å…³ æ˜¯djangoçš„ç‰¹æ€§ å¯ä»¥æ–¹ä¾¿çš„è¿›è¡Œå›ºå®šçš„é€‰æ‹©å‚¨å­˜ã€‚ä¾‹å¦‚ç”·å¥³ï¼Œå•ç‹¬ä¸ºç”·å¥³æ·»åŠ ä¸€ä¸ªcharå­—æ®µä¼šè¾ƒä¸ºæµªè´¹ç©ºé—´ï¼Œå› æ­¤ä½¿ç”¨1/2è¿™æ ·çš„æ•°å­—ä»£æ›¿ï¼Œä½†æ˜¯æ•°å­—ä¸æ˜“è¯»ï¼Œå› æ­¤djangoè®¾è®¡å‡ºäº†<code>choice</code>å‚æ•°ã€‚</li>
</ul>
<pre><code class="language-python">gender_choice = (
    (1,'ç”·'),
    (2,'å¥³'),
) #æ³¨æ„æ˜¯å…ƒç»„å¥—å…ƒç»„
gender = models.SmallIntegerField(verbose_name='æ€§åˆ«',choices = gender_choice) #verbose_nameå°±æ˜¯å¯¹åˆ—åï¼ˆå±æ€§ï¼‰çš„æ³¨è§£ å¯å†™å¯ä¸å†™ å†™ä¸Šä¸ºå¥½
#SmallIntegerFieldæ˜¯å°æ•´æ•°å­—æ®µ
</code></pre>
<ul>
<li>è¿™æ ·å­—æ®µçš„è·å–ï¼šå¦‚æœç›´æ¥<code>obj.gender</code>è·å–çš„å°±æ˜¯æ•°æ®åº“ä¸­å¯¹åº”çš„æ•°å­—ï¼Œä½†æ˜¯djangoå°è£…äº†ä¸€ä¸ªåˆ¤æ–­æ–¹æ³•ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„å¸®æˆ‘ä»¬åˆ¤æ–­ï¼Œç„¶åè¿”å›çš„æ˜¯æˆ‘ä»¬å¸Œæœ›ç°å®çš„å­—æ®µï¼š<code>obj.get_gender_display()</code>ã€‚å…¶ä¸­å‡½æ•°åå­—ç»„æˆæ–¹å¼ä¸º<code>get_å±æ€§åå­—/å­—æ®µåå­—_display()</code></li>
</ul>
<h3 id="11formå’Œmodelform">11.Formå’ŒModelForm</h3>
<ul>
<li>11.1 formç±» è‡ªåŠ¨ç”Ÿæˆè¡¨å•</li>
</ul>
<pre><code class="language-python">#views.py
class MyForm(Form):
    user = forms.CharField(widget=forms.Input)
    password = forms.CharField(widget=forms.Input)
    email = forms.CharField(widget=forms.Input)
def user_add(request):
    form = MyForm() #å®åŠ›åŒ–ä¸€ä¸ªformè¡¨å•ç±»
    return renderï¼ˆrequest,'user_add.html',{'form':form}
</code></pre>
<pre><code class="language-html">&lt;!-- user_add.html --&gt;
&lt;form method='post'&gt;
{% for i in form %}
{{ i }}
{% endfor %}
&lt;!-- æˆ–è€…ä¹Ÿå¯ä»¥ä¸€ä¸ªä¸€ä¸ªè‡ªå·±å†™å‡ºæ¥ æ¯”å¦‚{{form.user}} {{form.password}} --&gt;
&lt;/form&gt;
</code></pre>
<ul>
<li>11.2 ModelFormç»„ä»¶
<ul>
<li>å®ç°æ•°æ®åº“è¡¨å•å­—æ®µå’Œå‰ç«¯formè¡¨å•å­—æ®µçš„è‡ªåŠ¨ç”Ÿæˆ</li>
</ul>
<ul>
<li>å¯¹è¿æ¥è¡¨/å¤–é”®é™åˆ¶è‡ªåŠ¨ç”Ÿæˆé€‰æ‹©æ¡†</li>
<li>å®šä¹‰modelsç±»ä¸­çš„<code>__str__</code>æ–¹æ³•å®ç°å¯¹è¿æ¥è¡¨å±æ€§çš„ç›´æ¥å±•ç¤º</li>
<li>å®šä¹‰ç”Ÿæˆè¡¨å•æ ·å¼çš„å±æ€§</li>
<li><code>{{ obj.label }}</code>å¯ä»¥éå†å‡ºåœ¨modelformå®šä¹‰å­—æ®µä¸­çš„<code>label</code>å‚æ•°<br>
æ¥ä¸‹æ¥æ˜¯å…·ä½“çš„ä»£ç å±•ç¤º æœ‰ç‚¹å¤ªå¤šäº†...<br>
è®°å¾—æ·»åŠ äº†è·¯ç”±ï¼ï¼ï¼ï¼ˆè¿™ä¸ªå°±ä¸å±•ç¤ºåœ¨ä»£ç ä¸­äº†ï¼Œï¼‰</li>
</ul>
</li>
</ul>
<pre><code class="language-python">#views.py
#æ ¹æ®staffè¡¨å•ç”Ÿæˆmodelformç±»
class staffMdoelForm(ModelForm):
    class Meta:
        model = Staff
        fields = ['name','age','gender','phonenumber','create_time']

#æ·»åŠ å‘˜å·¥
def staff_add(request):
    form = staffMdoelForm() #å®ä¾‹åŒ–modelformç±» 
    return render(request,'staff_add.html',{
        'form':form
        })
</code></pre>
<pre><code class="language-html">&lt;div style=&quot;width:50%;margin-left: 25%;margin-top: 25px;&quot;&gt;
    &lt;div class=&quot;container&quot; &gt;
        &lt;form method=&quot;post&quot;&gt;
            &lt;h2&gt;æ·»åŠ æ–°çš„å‘˜å·¥ä¿¡æ¯&lt;/h2&gt;
            {% csrf_token %}
            {% for field in form %}
            &lt;div class=&quot;mb-3&quot;&gt;
                &lt;label class=&quot;form-label&quot;&gt;{{field.label}}&lt;/label&gt;
                {{ field }}
            &lt;/div&gt;
            {% endfor %}
            &lt;button type=&quot;submit&quot; class=&quot;btn btn-primary&quot;&gt;ç¡®è®¤æ·»åŠ &lt;/button&gt;
        &lt;/form&gt;
    &lt;/div&gt;    
&lt;/div&gt;
</code></pre>
<pre><code class="language-python">#è¿æ¥è¡¨modelformå¤„ç†ï¼ˆhtmlä¸ç”¨åšå¤ªå¤šæ”¹å˜ï¼‰
#åœ¨models.pyä¸­çš„ä»è¡¨æ·»åŠ __str__æ–¹æ³• è®©è°ƒç”¨è¿™ä¸ªç±»çš„æ—¶å€™è¿”å›çš„ä¸å†æ˜¯ä¸€ä¸ªqueryobjectè€Œæ˜¯__str__å®šä¹‰å¥½çš„è¿”å›å€¼
class Staff(models.Model):
    name = models.CharField(verbose_name='å‘˜å·¥å§“å',max_length=32)
......
    def __str__(self):
        return self.name
#åœ¨views.pyä¸­å®šä¹‰modelformç±»çš„æ—¶å€™ å­—æ®µé€‰æ‹©ç›´æ¥å†™å®šä¹‰çš„è€Œä¸æ˜¯åœ¨æ•°æ®åº“è¡¨å•ä¸­çš„å­—æ®µ
class userModelForm(ModelForm):
    class Meta:
        model = UserInfo #æ³¨ Userinfoè¡¨å•ä¸­çš„identifyæ˜¯å¼•ç”¨äº†Staffè¡¨å•ä¸­çš„idä½œä¸ºå¤–é”®
        fields = ['name','password','identify']
</code></pre>
<h3 id="12é‡å®šå‘">12.é‡å®šå‘</h3>
<ul>
<li><code>from django.shortcuts import redirect</code>æˆ–è€…<code>from django.http import HttpResponseRedirect</code><br>
returnä¸€ä¸ªé‡å®šå‘urlçš„å®ä¾‹å³å¯</li>
</ul>
<h3 id="13å‰ç«¯urlå®ç°åˆ é™¤è¯·æ±‚">13.å‰ç«¯urlå®ç°åˆ é™¤è¯·æ±‚</h3>
<ul>
<li>é€šè¿‡å‰ç«¯å‘é€ä¸€ä¸ªå¸¦æœ‰åˆ é™¤ç›®æ ‡ä¿¡æ¯çš„GETè¯·æ±‚ï¼Œç„¶ååç«¯è·å–åˆ é™¤å³å¯ï¼Œä½†æ˜¯è¿™ä¸ªå¸¦æœ‰åˆ é™¤ç›®æ ‡ä¿¡æ¯çš„urlè¯¥å¦‚ä½•ç»„è£…å‘¢ï¼Ÿé€šè¿‡urlçš„ç»„æˆè§„å¾‹ï¼Œæ·»åŠ <code>/?id=</code>ä¿¡æ¯ä¼ é€’ï¼Œä»£ç å¦‚ä¸‹ï¼š<br>
<code>&lt;a href=&quot;/login/manage/delete/?id={{user.0}}&quot;&gt;åˆ é™¤&lt;/a&gt;</code>  #è¿™å…¶ä¸­çš„{{id.0}}é€šè¿‡djangoçš„æ¨¡æ¿è¯­æ³•åŠ¨æ€èµ‹äºˆç›®æ ‡çš„idä¿¡æ¯<br>
å¯¹åº”å¤„ç†å‡½æ•°ï¼ˆè®°å¾—æ³¨å†Œurlï¼‰</li>
</ul>
<pre><code class="language-python">def delete_user_info(request):
    id = request.GET.get('id')
    UserInfo.objects.filter(id = id).delete()
    return HttpResponseRedirect('/login/manage/')
</code></pre>
<h3 id="14djangoçš„æ¨¡æ¿è¯­æ³•">14.djangoçš„æ¨¡æ¿è¯­æ³•</h3>
<ul>
<li>å…¶ä¸­æœ€å¼€å§‹çš„<code>{% extends 'nav.html'%}</code>å¿…é¡»å¤„äºå­é¡µé¢çš„ç¬¬ä¸€ä¸ªåŠ è½½ä½ç½®ï¼Œæ„å‘³ç€å¦‚æœå‰é¢æœ‰å“ªæ€•<code>{% load static %}</code>ä¹Ÿä¼šæŠ¥é”™ã€‚</li>
</ul>
<h3 id="15djangoæ­£åˆ™åŒ¹é…url">15.djangoæ­£åˆ™åŒ¹é…url</h3>
<ul>
<li>è¿™æ ·å°±ä¸ç”¨å‰ç«¯å†™å¸¦æœ‰getå‚æ•°çš„urlï¼Œåç«¯ä¹Ÿä¸éœ€è¦getè·å–,è€Œæ˜¯ç›´æ¥ä½œä¸ºä¸€ä¸ªè§£æå¥½çš„å‚æ•°ä¼ é€’ç»™è§†å›¾è¿›è¡Œå¤„ç†ï¼ŒäºŒæ˜¯ç›´æ¥åŠè¿›è¡Œè¯·æ±‚å’Œè§£æã€‚åŒæ—¶ä¹Ÿè¦æ³¨æ„ï¼Œåœ¨urlä¸­æ·»åŠ çš„æ­£åˆ™é¡ºåºä¸å½±å“åœ¨å‘½åurlä¸­çš„å‚æ•°é¡ºåº</li>
</ul>
<ul>
<li>å…·ä½“å¦‚ä¸‹ï¼š</li>
</ul>
<pre><code class="language-python">#htmlä¸­
&lt;a href=&quot;{% url 'edit' user.0 %}&quot;&gt;æ“ä½œ...&lt;/a&gt;
#urlä¸­
path('login/manage/&lt;int:id&gt;/edit/',views.edit_user_info,name = 'edit')
#viewsä¸­
def edit_user_info(request,id):
    default_userinfo = UserInfo.objects.filter(id = id).first()
    ....
</code></pre>
<p>å¯ä»¥çœ‹åˆ°<code>&lt;int:id&gt;</code>æ˜¯åœ¨<code>/edit/</code>ä¹‹å‰çš„ï¼Œä½†æ˜¯åœ¨htmlçš„urlä¸­è¿™ä¸ªé¡ºåºä¸å½±å“ã€‚åŒæ—¶åœ¨viewsä¸­å¯¹åº”çš„å‡½æ•°å¯ä»¥ç›´æ¥æ¥æ”¶åˆ°urlä¸­æ­£åˆ™åŒ¹é…åˆ°çš„å‚æ•°ï¼Œè€Œä¸ç”¨å†é€šè¿‡è§£ægetè¯·æ±‚è·å–ã€‚</p>
<h3 id="16åœ¨djangoçš„æ¨¡æ¿ä¸­å¯ä»¥é€šè¿‡objget_è”è¡¨å_displayè·å–åˆ°å’Œåç«¯get_è”è¡¨å_displayçš„æ•ˆæœç›´æ¥è¿”å›å¯¹ç…§è¿‡åçš„ç»“æœè€Œä¸æ˜¯å¯¹åº”çš„å…³è”id">16.åœ¨djangoçš„æ¨¡æ¿ä¸­ï¼Œå¯ä»¥é€šè¿‡<code>obj.get_è”è¡¨å_display</code>è·å–åˆ°å’Œåç«¯<code>get_è”è¡¨å_display()</code>çš„æ•ˆæœï¼Œç›´æ¥è¿”å›å¯¹ç…§è¿‡åçš„ç»“æœè€Œä¸æ˜¯å¯¹åº”çš„å…³è”idã€‚</h3>
<h3 id="17djangoçš„æ¨¡æ¿å¯ä»¥è¿›è¡Œçš„é¢å¤–æ“ä½œ">17.djangoçš„æ¨¡æ¿å¯ä»¥è¿›è¡Œçš„é¢å¤–æ“ä½œï¼š</h3>
<ul>
<li><code>{{number : add 1}}</code>å°±æ˜¯pythonçš„<code>+=1</code>æ“ä½œï¼Œ<code>{{datetime | date :'Y-m-d}}</code>å°±æ˜¯pythonä¸­çš„<code>strftime()</code>å‡½æ•°(è¦æ³¨æ„çš„æ˜¯é‡Œé¢çš„æ ¼å¼ä¸éœ€è¦å¸¦<code>%</code>)</li>
</ul>
<h3 id="18modelformçš„å­—æ®µæ ¡éªŒå‡½æ•°">18.modelformçš„å­—æ®µæ ¡éªŒå‡½æ•°</h3>
<ul>
<li><code>is_valid()</code>æ£€éªŒæäº¤postè¯·æ±‚ä¸­çš„formè¡¨å•ä¸­çš„å­—æ®µæ˜¯å¦ä¸ºç©ºï¼Œå…·ä½“çš„å­—æ®µå°±æ˜¯åœ¨<code>modelform</code>ä¸­<code>fields</code>åˆ—è¡¨å®šä¹‰çš„é‚£äº›.</li>
<li>åŒæ—¶è¿˜å¯ä»¥åœ¨modelformsç±»ä¸­è¿›è¡Œå­—æ®µæ ¡éªŒ é”™è¯¯çš„ä¿¡æ¯ä¼šä¿å­˜åœ¨ç”¨postè¯·æ±‚å®ä¾‹åŒ–çš„modelformä¸­ã€‚</li>
</ul>
<pre><code class="language-python">class staffMdoelForm(ModelForm):
    phonenumber = forms.CharField(label='ç”µè¯å·ç ',max_length=11,min_length=11)#è¿›è¡Œçš„å­—æ®µæ ¡éªŒ 
    #è§„å®šç”µè¯å·ç çš„é•¿åº¦ä¸º11ä½
    #è¿˜å¯ä»¥é€šè¿‡validatorså‚æ•°è¿›è¡Œæ­£åˆ™ç­›é€‰
    class Meta:
        model = Staff
        fields = ['name','age','gender','phonenumber','create_time']
    phonenumber = forms.CharField(label='ç”µè¯å·ç ',max_length=11,min_length=11)
    #è§„å®šç”µè¯å·ç çš„é•¿åº¦ä¸º11ä½
    #è¿˜å¯ä»¥é€šè¿‡validatorså‚æ•°è¿›è¡Œæ­£åˆ™ç­›é€‰
</code></pre>
<h3 id="19è°ƒæ•´è¿”å›çš„æç¤ºä¿¡æ¯ä¸ºæ±‰è¯­">19.è°ƒæ•´è¿”å›çš„æç¤ºä¿¡æ¯ä¸ºæ±‰è¯­</h3>
<ul>
<li>é€šè¿‡ä¿®æ”¹setting.pyæ–‡ä»¶ä¸­çš„è¯­è¨€é¡¹</li>
</ul>
<pre><code class="language-python">#setting.py
# LANGUAGE_CODE = &quot;en-us&quot; æ³¨é‡Šæ‰
LANGUAGE_CODE = &quot;zh-hans&quot; #æ·»åŠ 
</code></pre>
<h3 id="20modelformä¸­instanceå‚æ•°">20.modelformä¸­<code>instance</code>å‚æ•°</h3>
<ul>
<li>é€šè¿‡è®¾ç½®å•æ¡æ•°æ®å¯¹è¡¨å•è¿›è¡Œå¡«å……ï¼Œä¾‹å¦‚ï¼š</li>
</ul>
<pre><code class="language-python">#views.pyä¸­çš„ä¸€ä¸ªæ–¹æ³•
default_userinfo = UserInfo.objects.filter(id = id).first() #æ ¹æ®idåœ¨æ•°æ®åº“ä¸­è·å–å¯¹åº”çš„ä¸€æ¡æ•°æ®
userform = userModelForm(instance=default_userinfo) # é€šè¿‡instanceå‚æ•°è®¾å®šä¸€ä¸ªå®ä¾‹åŒ–çš„è¡¨å• è®©ä»–åœ¨å‰ç«¯æ¸²æŸ“çš„æ—¶å€™è‡ªåŠ¨åœ¨valueä¸Šæ˜¾ç¤ºä»æ•°æ®åº“ä¸­æ‹¿åˆ°çš„é»˜è®¤å€¼
</code></pre>
<ul>
<li>é€šè¿‡<code>instance</code>å‚æ•°å’Œ<code>data</code>å‚æ•°å¯ä»¥å®ç°æ•°æ®åº“æ•°æ®çš„æ›´æ–°</li>
</ul>
<pre><code class="language-python">#åœ¨views.pyä¸­çš„æŸä¸ªå‡½æ•°
default_userinfo = UserInfo.objects.filter(id = id).first()
userform = userModelForm(data=request.POST,instance=default_userinfo)
if userform.is_valid():
    userform.save()
    return redirect('/login/manage/')
else:
    return render(request,'edit_info.html',{
        'userform': userform,
    })
</code></pre>
<ul>
<li>å¦‚æœæƒ³åœ¨ç”¨æˆ·è¾“å…¥ä»¥å¤–çš„å­—æ®µè¿›è¡Œæ›´æ–°ï¼Œé‚£ä¹ˆåœ¨modelformå®ä¾‹åŒ–ä¹‹åé€šè¿‡<code>instacne</code>å±æ€§å¯ä»¥ä¿®æ”¹ï¼š</li>
</ul>
<pre><code class="language-python">userform = userModelForm(data=request.POST,instance=default_userinfo)
# useform.instance.å­—æ®µ =  å€¼
</code></pre>
<h3 id="21djangoæŸ¥è¯¢æ’åº">21.djangoæŸ¥è¯¢æ’åº</h3>
<ul>
<li><code>obj.objects.all().order_by('å±æ€§å')</code><br>
å¦‚æœç»™å±æ€§åå‰é¢æ·»åŠ å‡å· ä»£è¡¨é€†å‘ï¼ˆé«˜åˆ°ä½ï¼‰æ’åº</li>
</ul>
<h3 id="22ç»™åŸæœ‰çš„è¡¨ä¸­æ·»åŠ æ–°çš„å­—æ®µäº§ç”Ÿé”™è¯¯djangocoreexceptionsvalidationerror-error">22.ç»™åŸæœ‰çš„è¡¨ä¸­æ·»åŠ æ–°çš„å­—æ®µäº§ç”Ÿé”™è¯¯<code>&quot;django.core.exceptions.ValidationError&quot; error</code></h3>
<ul>
<li>äº§ç”ŸåŸå› ï¼šå¤§æ¦‚ç‡æ˜¯å› ä¸ºè¿½åŠ æ–°çš„å­—æ®µè®¾ç½®é»˜è®¤å€¼çš„æ—¶å€™äº§ç”Ÿçš„æ ¼å¼é”™è¯¯ï¼Œä¾‹å¦‚datetimeæ ¼å¼ä½†æ˜¯æ²¡æœ‰è®¾ç½®é»˜è®¤æˆ–è€…é»˜è®¤æ ¼å¼é”™è¯¯ï¼Œé€ æˆè¿™æ ·çš„åŸå› ã€‚</li>
<li>è§£å†³æ–¹æ³•ï¼šé‡ç½®æ‰€æœ‰çš„<code>migrations</code></li>
<li>æ“ä½œï¼šåˆ é™¤migrationsæ–‡ä»¶å¤¹ä¸‹é™¤äº†<code>__init__.py</code>æ–‡ä»¶ä»¥å¤–æ‰€æœ‰çš„æ–‡ä»¶ï¼Œç„¶åé‡æ–°æ‰§è¡Œæ•°æ®åº“è¿ç§»å‘½ä»¤ï¼š<code>python manage.py makemigrations</code>, <code>python manage.py migrate</code></li>
<li>å¦‚æœè¿˜ä¸æˆåŠŸå¯èƒ½æ˜¯å› ä¸ºæ•°æ®åº“ä¸­åŸæœ¬å­˜åœ¨çš„æ•°æ®å¯¼è‡´ï¼Œå°†æ•°æ®åº“æ¸…åº“ï¼ˆæ‰€æœ‰è¡¨åˆ é™¤ï¼‰ï¼Œç„¶ååœ¨æ‰§è¡Œå³å¯ã€‚</li>
</ul>
<h3 id="23djangoæŠ¥é”™orderform-object-has-no-attribute-get">23.djangoæŠ¥é”™<code>'orderForm' object has no attribute 'get'</code></h3>
<ul>
<li>åŸå› æ˜¯åœ¨è®¾ç½®<code>input</code>æ ‡ç­¾çš„æ ·å¼çš„æ—¶å€™é‡å†™çš„çˆ¶ç±»æ–¹æ³•å‡ºé”™ï¼Œå‚æ•°å¤šå†™äº†ä¸€ä¸ª<code>self</code></li>
</ul>
<pre><code class="language-python">#é”™è¯¯æºç 
    def __init__(self,*arg,**kwargs):
        super().__init__(self,*arg,**kwargs)
        for name, field in self.fields.items():
            # print(name,field) #è¿™ä¸ªæ˜¯å±•ç¤º self.fields.items()å¯ä»¥ç›´æ¥æ‹¿åˆ°å®šä¹‰åœ¨Metaä¸­çš„fieldså­—æ®µ
            field.widget.attrs = {'class' : 'form-control'} #ä¸ºç”Ÿæˆçš„è¡¨å•inputèµ‹äºˆcsså±æ€§ 
</code></pre>
<ul>
<li>è§£å†³æ–¹æ³• ï¼š å»æ‰<code>super().__init__(self,*arg,**kwargs)</code>è¿™ä¸€è¡Œä¸­çš„selfå³å¯ï¼Œæ­£ç¡®å†™æ³•ï¼š<br>
<code>  super().__init__(*arg,**kwargs)</code></li>
<li>æ¢ç©¶ä¸€ä¸‹ä¸ºä»€ä¹ˆ<code>super</code>ä¸éœ€è¦<code>self</code>ä½œä¸ºæ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼š<br>
å› ä¸º<code>super()</code>æ˜¯ä¸€ä¸ªç±» <a href="https://mozillazg.com/2016/12/python-super-is-not-as-simple-as-you-thought.html#hidsuper">reference</a> -- æ„Ÿè§‰å¥½å¤š...æš‚æ—¶æç½®ä¸€ä¸‹...ğŸ˜–</li>
</ul>
<h3 id="24å…³é—­æµè§ˆå™¨æ ¡éªŒ">24.å…³é—­æµè§ˆå™¨æ ¡éªŒ</h3>
<p>åœ¨formè¡¨å•æ·»åŠ <code>novalidate</code></p>
<pre><code class="language-html">&lt;form method=&quot;post&quot; novalidate &gt;
</code></pre>
<h3 id="25å…³äºmodelsä¸­nullå’Œblackå­—æ®µ">25.å…³äºmodelsä¸­nullå’Œblackå­—æ®µ</h3>
<ul>
<li>éœ€è¦åŒæ—¶å¼€å¯ï¼Œä½†æ˜¯æ•°æ®åº“æ›´æ¨èé»˜è®¤å€¼ä¸ºç©ºå€¼ï¼Œå› æ­¤è®¾ç½®<code>default=None</code>è€Œä¸æ˜¯<code>null</code>ã€‚<br>
å¦‚æœè®¾ç½®<code>blank=True</code>ä½†æ˜¯ä¸å¼€å¯<code>null=True</code>ï¼Œé‚£ä¹ˆåœ¨æ’å…¥çš„æ—¶å€™ï¼Œå¦‚æœä¼ å›æ¥çš„æ•°æ®ä¸ºç©ºï¼Œæ’å…¥ä¼šæŠ¥é”™ä¸èƒ½ä¸ºnullå­—æ®µ...æ€»ä¹‹è¿˜æ˜¯å¾ˆè¿·æƒ‘çš„æŠ¥é”™....ä½†æ˜¯è§£å†³æ–¹æ³•è¿˜æ˜¯æœ€å¥½è®¾ç½®ä¸¤ä¸ªéƒ½ä¸ºTrueå¹¶ä¸”è®¾ç½®é»˜è®¤å­—æ®µä¸º<code>None</code>ã€‚å¦‚æœä¸º<code>null</code>ï¼Œé‚£ä¹ˆåœ¨æ•°æ®ä¼ å…¥åˆ°å‰ç«¯çš„æ—¶å€™ä¼šé»˜è®¤è¾“å‡ºnullæˆ–è€…noneï¼Œè€Œä¸æ˜¯å°†é‚£ç‰‡åŒºåŸŸç½®ç©ºï¼Œå¯¹äºå‰ç«¯çš„ç”¨æˆ·è¾“å…¥é€»è¾‘ä¸å¤ªå‹å¥½ã€‚</li>
</ul>
<h3 id="26modelformsä¾¿æ·å†™æ³•">26.modelformsä¾¿æ·å†™æ³•</h3>
<ul>
<li>åœ¨æ·»åŠ fieldsçš„æ—¶å€™ï¼Œå¯ä»¥ç”¨<code>__all__</code>ä¸€æ¬¡æ€§è·å–å…¨éƒ¨ï¼Œ<code>exclude = [ æ’é™¤çš„å­—æ®µ ]</code>æ’é™¤æ‰ä¸è¦çš„å­—æ®µã€‚</li>
</ul>
<pre><code class="language-python">class orderForm(ModelForm):
    class Meta():
        model = Orderform
        fields = &quot;__all__&quot; #æ³¨æ„è¦å¼•å·
        # exclude = ['å­—æ®µ1','å­—æ®µäºŒ', .... ]
</code></pre>
<h3 id="27åç«¯è¡¨å•æ­£åˆ™æ ¡éªŒ">27.åç«¯è¡¨å•æ­£åˆ™æ ¡éªŒ</h3>
<ul>
<li>åœ¨modelformsç±»ä¸­å£°æ˜å­—æ®µï¼Œç„¶åé€šè¿‡validatorså‚æ•°è®¾ç½®æ­£åˆ™è¡¨è¾¾å¼ï¼š</li>
</ul>
<pre><code class="language-python">from django.core.validators import RegexValidator #éœ€è¦å¯¼å…¥æ­£åˆ™ç±»
class exampleModelForms(forms.ModelForm):
    moblie = forms.CharField(
        label = 'æ‰‹æœºå·ç ',
        validactors = [RegexValidator(r'^1[3-9]\d{9}$','æ‰‹æœºå·æ ¼å¼é”™è¯¯')]       
        #æ ¡éªŒå¤±è´¥è¿”å›åé¢çš„æç¤ºä¿¡æ¯è€Œä¸æ˜¯é»˜è®¤çš„äº†~ 
    )
</code></pre>
<h3 id="28é’©å­æ–¹æ³•è¿›è¡Œå­—æ®µæ ¡éªŒ">28.é’©å­æ–¹æ³•è¿›è¡Œå­—æ®µæ ¡éªŒ</h3>
<ul>
<li><a href="https://www.cnblogs.com/open-yang/p/11223175.html">è¯¦ç»†çš„</a></li>
<li>è¿™é‡Œæ‘˜åˆ—å‡ºå¸¸ç”¨çš„ä»£ç ç»“æœ</li>
</ul>
<pre><code class="language-python">class exampleModelForms(forms.ModelForm):
   def clean_å­—æ®µå(self): #è¿™ä¸ªéœ€è¦åœ¨ä¸€ä¸ªmodelformç±»ä¸­ è¿™ä¸ªå‡½æ•°åmodelformä¼šè‡ªåŠ¨ç”Ÿæˆå¯¹åº”çš„æ–¹æ³•
           pass 
           name = self.cleaned_data.get('name')
           if name=='admin':
               raise ValidationError('adminæ˜¯è¶…çº§ç®¡ç†å‘˜ï¼Œä¸èƒ½æ³¨å†Œï¼')#è¿™ä¸ªé”™è¯¯ä¼šç›´æ¥æ‰”è¿›è¯¥å­—æ®µçš„é”™è¯¯ç±»åˆ«ä¸­ï¼šname.errors
           return self.cleaned_data.get('name')
</code></pre>
<h3 id="29è§„å®šmodelformä¸­ä¸å¯ç¼–è¾‘çš„éƒ¨åˆ†">29.è§„å®šmodelformä¸­ä¸å¯ç¼–è¾‘çš„éƒ¨åˆ†</h3>
<p>åœ¨modelformä¸­å­—æ®µä¸­è®¾ç½®å‚æ•°<code>disabled= True</code>å³å¯ï¼Œè¿™æ ·åœ¨å‰ç«¯é¡µé¢æ¸²æŸ“å‡ºæ¥çš„è¿™ä¸€æ¡å­—æ®µæ˜¯ä¸å¯ä»¥æ›´æ”¹çš„ã€‚</p>
<h3 id="30é€šè¿‡modelformåˆ¤æ–­è¦æ·»åŠ çš„æ•°æ®æ˜¯å¦é‡å¤">30.é€šè¿‡modelformåˆ¤æ–­è¦æ·»åŠ çš„æ•°æ®æ˜¯å¦é‡å¤</h3>
<ul>
<li><code>order_edit_form = orderEditForm().filter(id=ä½ è¦æŸ¥è¯¢çš„).exist()</code> è¿”å›True/False<br>
è¿™ä¸ªæ–¹æ³•éœ€è¦æ·»åŠ åœ¨modelformä¸­çš„é’©å­æ–¹æ³•ä¸­ã€‚</li>
<li>æ’é™¤è‡ªå·±ä»¥å¤–çš„æ˜¯å¦å­˜åœ¨é‡å¤ï¼Ÿ(ä¸»è¦æ˜¯åœ¨ä¿®æ”¹æ•°æ®çš„æ—¶å€™ï¼‰<br>
é€šè¿‡<code>exclude</code>æ’é™¤è‡ªå·±ååˆ¤æ–­ï¼š<code>order_edit_form = orderEditForm().exclude(id='è‡ªå·±çš„id' ).filter(id=ä½ è¦æŸ¥è¯¢çš„).exist()</code> è¿”å›True/False</li>
</ul>
<p>æ€»ç»“ ç¼–è¾‘å’Œæ·»åŠ çš„ä¸åŒ</p>
<h3 id="31æŸ¥è¯¢æ ¹æ®æŸä¸ªå­—çš„ä¸€éƒ¨åˆ†è¿›è¡Œ">31.æŸ¥è¯¢ï¼ˆæ ¹æ®æŸä¸ªå­—çš„ä¸€éƒ¨åˆ†è¿›è¡Œï¼‰</h3>
<ul>
<li><code>filter()</code>è¿˜æ”¯æŒä¼ å…¥å­—å…¸ï¼š</li>
</ul>
<pre><code class="language-python">order_edit_form = orderEditForm().filter(id=ä½ è¦æŸ¥è¯¢çš„,other=ä½ è¦æŸ¥è¯¢çš„)
#ç­‰äº
query_dict = { 'id' : è¦æŸ¥è¯¢çš„, 'other' : è¦æŸ¥è¯¢çš„ }
order_edit_form = orderEditForm().filter(**query_dict)
 #éœ€è¦æ³¨æ„ä¼ å…¥å­—å…¸çš„æ—¶å€™éœ€è¦ä¸¤ä¸ª**
</code></pre>
<p>PS. é€šå¸¸æˆ‘ä»¬å†å˜é‡å‰åŠ ä¸€ä¸ªæ˜Ÿå·(*)è¡¨ç¤ºè¿™ä¸ªå˜é‡æ˜¯å…ƒç»„/åˆ—è¡¨ï¼ŒåŠ ä¸¤ä¸ªæ˜Ÿå·è¡¨ç¤ºè¿™ä¸ªå‚æ•°æ˜¯å­—å…¸</p>
<h3 id="32é—®é¢˜è®°å½•modelformä¸èƒ½æ›´æ–°ä¸€è¡Œæ•°æ®çš„éƒ¨åˆ†å­—æ®µ">32.é—®é¢˜è®°å½•ï¼šmodelformä¸èƒ½æ›´æ–°ä¸€è¡Œæ•°æ®çš„éƒ¨åˆ†å­—æ®µ</h3>
<ul>
<li><a href="https://www.qiniu.com/qfans/qnso-8216353#comments">è§£å†³æ–¹æ³•</a><br>
è¿™é‡Œçš„è§£å†³æ–¹æ³•å¾ˆå¤š åŒ…æ‹¬è‡ªå®šä¹‰é’©å­å‡½æ•°å¯¹postæ•°æ®è¿›è¡Œæ¸…æ™°ã€å®šä¹‰ä¸€ä¸ªå·¥å‚å‡½æ•°å¤„ç†æ¯æ¬¡ä¸åŒçš„å­—æ®µç­‰ï¼Œä¸è¿‡éƒ½å¤ªé«˜ç«¯äº†ï¼Œéƒ¨åˆ†æ¦‚å¿µæˆ‘è¿˜æ²¡æœ‰ç†è§£æ¸…æ¥šğŸ˜­</li>
<li>å› æ­¤æˆ‘æ‰“ç®—é‡‡å–æœ€ç®€å•çš„ -- ä¸€ä¸ªå­—æ®µä¸€ä¸ªå­—æ®µçš„å»<code>update</code>ğŸ˜³ã€‚ æˆ–è€…é‡‡ç”¨dictçš„æ¨¡å¼ï¼Œå¤„ç†ä¸å˜çš„å­—æ®µå’Œæ›´æ–°åçš„å­—æ®µ ç»„åˆæˆä¸ºä¸€ä¸ªæ›´æ–°åçš„å­—å…¸ç„¶åé€šè¿‡modelformä¿å­˜..</li>
<li>æœ€åå‘ç°æ˜¯æˆ‘å®ä¾‹åŒ–å‡ºé”™äº†çš„é—®é¢˜....(çœŸè¯šçš„çœ¼çğŸ˜­)</li>
</ul>
<pre><code class="language-python">    row_object = Orderform.objects.filter(id = id).first() #æ³¨æ„è¿™é‡Œå®ä¾‹åŒ–çš„æ˜¯ä¸€ä¸ªformç±» ä¹‹å‰é”™è¯¯çš„åŸå› æ˜¯è¿™é‡Œä¹Ÿå†™æˆäº†ä¸€ä¸ªmodelformç±» è¿™å°±å¯¼è‡´ä¸‹é¢instanceçš„æ—¶å€™ä¼šæŠ¥é”™ è€Œä¸”é»˜è®¤ä¸æ›´æ–°çš„å‰ç«¯æ•°æ®å®é™…ä¸Šæ˜¯ä¼šä¼ é€’å›æ¥çš„ ä½œä¸ºè¡¨å•çš„é»˜è®¤å€¼
    order_edit_form = orderEditForm(data=request.POST,instance=row_object) 
    #è¿™é‡Œå®ä¾‹åŒ–çš„æ˜¯ä¸€ä¸ªmodelformsç±»
</code></pre>
<h3 id="33djangoçš„æ¡ä»¶æŸ¥è¯¢">33.djangoçš„æ¡ä»¶æŸ¥è¯¢</h3>
<p>é™¤äº†å›ºå®šçš„ç­‰äºï¼ˆ<code>=</code>ï¼‰æŸ¥è¯¢å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡ç»™å­—æ®µ/å±æ€§æ·»åŠ ä¸‹åˆ’çº¿çš„æ–¹å¼è§„å®šèŒƒå›´æŸ¥è¯¢</p>
<ul>
<li>æ•°å­—æ–¹é¢ï¼šgtã€gteã€ltã€lteï¼šå¤§äºã€å¤§äºç­‰äºã€å°äºã€å°äºç­‰äºã€‚<br>
<code>list = BookInfo.objects.filter(id__gt=3) </code> ä»£è¡¨idå¤§äº3çš„æ•°æ®<br>
PS. ä¸ç­‰äºå¯ä»¥é€šè¿‡<code>exclude</code>è¿‡æ»¤</li>
<li>å­—ç¬¦ä¸²æ–¹é¢ï¼šstartswithã€endswithï¼šä»¥æŒ‡å®šå€¼å¼€å¤´æˆ–ç»“å°¾ï¼›containsï¼šæ˜¯å¦åŒ…å«ã€‚<br>
<code>list = BookInfo.objects.filter(btitle__endswith='éƒ¨')</code> æŸ¥è¯¢æ˜¯å¦æ•°æ®ä¸­btitleå­—æ®µä»¥â€˜éƒ¨â€™è¿™ä¸ªå­—ç»“å°¾çš„ä¸€è¡Œæ•°æ®ã€‚</li>
<li>æ—¥æœŸæŸ¥è¯¢ï¼š yearã€monthã€dayã€week_dayã€hourã€minuteã€secondï¼šå¯¹æ—¥æœŸæ—¶é—´ç±»å‹çš„å±æ€§è¿›è¡Œè¿ç®—ã€‚<br>
<code>list = BookInfo.objects.filter(bpub_date__year=1980)</code> æŸ¥è¯¢1980å¹´å‘è¡¨çš„å›¾ä¹¦<br>
<code>list = BookInfo.objects.filter(bpub_date__gt=date(1990,1,1))</code>  æŸ¥è¯¢1980å¹´1æœˆ1æ—¥åå‘è¡¨çš„å›¾ä¹¦ã€‚</li>
<li>è¿˜æœ‰å¾ˆå¤šæŸ¥è¯¢ï¼š ä¾‹å¦‚æ¯”è¾ƒåŒä¸€è¡Œæ•°æ®ä¸¤ä¸ªå­—æ®µä¹‹é—´çš„å…³ç³»ï¼ˆå¦‚é˜…è¯»æ•°é‡&gt;=è¯„è®ºæ•°é‡ï¼‰ã€ä¸æˆ–éæŸ¥è¯¢ã€èšåˆç­‰... å…·ä½“å‚è€ƒ<a href="https://www.jianshu.com/p/bde1ece240bc">reference</a>æˆ–è€…å®˜ç½‘</li>
</ul>
<p>PS. 1. <code>filter</code>å¯ä»¥è¿ç»­ä½¿ç”¨ ï¼š<code>list=BookInfo.objects.filter(bread__gt=20).filter(id__lt=3)</code> 2. <code>filter</code>å¯ä»¥ä¼ å…¥å­—å…¸</p>
<h3 id="34è®¾ç½®geté»˜è®¤å€¼">34.è®¾ç½®geté»˜è®¤å€¼</h3>
<ul>
<li><code>request.GET.get('page', '1')</code> è·å–getè¯·æ±‚ï¼Œå¦‚æœgetæ²¡æœ‰é™„å¸¦pageå‚æ•°ï¼Œé‚£ä¹ˆé»˜è®¤æ˜¯1.</li>
</ul>

              </div>
              <div class="toc-container">
                <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#%E5%AD%A6%E4%B9%A0%E8%A7%86%E9%A2%91"><strong>å­¦ä¹ è§†é¢‘</strong></a>
<ul>
<li><a href="#1%E8%AF%B7%E6%B1%82%E5%92%8C%E5%93%8D%E5%BA%94">1.è¯·æ±‚å’Œå“åº”</a></li>
<li><a href="#2%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C">2.æ•°æ®åº“æ“ä½œ</a></li>
<li><a href="#3%E8%AE%A9django%E5%B8%AE%E5%8A%A9%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8">3.è®©djangoå¸®åŠ©åˆ›å»ºæ•°æ®åº“è¡¨</a></li>
<li><a href="#4%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4">4.æ‰§è¡Œå‘½ä»¤</a></li>
<li><a href="#5%E9%9C%80%E8%A6%81%E6%B3%A8%E6%84%8F">5.éœ€è¦æ³¨æ„</a></li>
<li><a href="#6%E9%80%9A%E8%BF%87django%E5%90%91%E8%A1%A8%E4%B8%AD%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE">6.é€šè¿‡djangoå‘è¡¨ä¸­æ’å…¥æ•°æ®</a></li>
<li><a href="#7django%E8%A1%A8%E5%8D%95%E5%A6%82%E6%9E%9C%E4%B8%8D%E5%86%99action-%E9%82%A3%E4%B9%88%E9%BB%98%E8%AE%A4%E6%8F%90%E4%BA%A4%E5%B0%B1%E6%98%AF%E5%90%91%E5%BD%93%E5%89%8D%E9%A1%B5%E9%9D%A2%E5%8F%91%E9%80%81%E4%B8%80%E4%B8%AApost%E8%AF%B7%E6%B1%82">7.djangoè¡¨å•å¦‚æœä¸å†™action é‚£ä¹ˆé»˜è®¤æäº¤å°±æ˜¯å‘å½“å‰é¡µé¢å‘é€ä¸€ä¸ªpostè¯·æ±‚</a></li>
<li><a href="#8django%E4%B8%AD%E7%9A%84url%E5%91%BD%E5%90%8D%E8%83%BD%E9%81%BF%E5%85%8D%E5%AF%B9url%E7%9A%84%E7%A1%AC%E7%BC%96%E7%A0%81">8.djangoä¸­çš„urlå‘½åèƒ½é¿å…å¯¹urlçš„ç¡¬ç¼–ç ï¼Œ</a></li>
<li><a href="#9model%E6%B7%BB%E5%8A%A0%E7%BA%A6%E6%9D%9F-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E7%BA%A6%E6%9D%9F">9.modelæ·»åŠ çº¦æŸ (æ•°æ®åº“çš„çº¦æŸ)</a></li>
<li><a href="#10%E6%80%A7%E5%88%AB%E5%AD%98%E5%82%A8">10.æ€§åˆ«å­˜å‚¨</a></li>
<li><a href="#11form%E5%92%8Cmodelform">11.Formå’ŒModelForm</a></li>
<li><a href="#12%E9%87%8D%E5%AE%9A%E5%90%91">12.é‡å®šå‘</a></li>
<li><a href="#13%E5%89%8D%E7%AB%AFurl%E5%AE%9E%E7%8E%B0%E5%88%A0%E9%99%A4%E8%AF%B7%E6%B1%82">13.å‰ç«¯urlå®ç°åˆ é™¤è¯·æ±‚</a></li>
<li><a href="#14django%E7%9A%84%E6%A8%A1%E6%9D%BF%E8%AF%AD%E6%B3%95">14.djangoçš„æ¨¡æ¿è¯­æ³•</a></li>
<li><a href="#15django%E6%AD%A3%E5%88%99%E5%8C%B9%E9%85%8Durl">15.djangoæ­£åˆ™åŒ¹é…url</a></li>
<li><a href="#16%E5%9C%A8django%E7%9A%84%E6%A8%A1%E6%9D%BF%E4%B8%AD%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87objget_%E8%81%94%E8%A1%A8%E5%90%8D_display%E8%8E%B7%E5%8F%96%E5%88%B0%E5%92%8C%E5%90%8E%E7%AB%AFget_%E8%81%94%E8%A1%A8%E5%90%8D_display%E7%9A%84%E6%95%88%E6%9E%9C%E7%9B%B4%E6%8E%A5%E8%BF%94%E5%9B%9E%E5%AF%B9%E7%85%A7%E8%BF%87%E5%90%8E%E7%9A%84%E7%BB%93%E6%9E%9C%E8%80%8C%E4%B8%8D%E6%98%AF%E5%AF%B9%E5%BA%94%E7%9A%84%E5%85%B3%E8%81%94id">16.åœ¨djangoçš„æ¨¡æ¿ä¸­ï¼Œå¯ä»¥é€šè¿‡<code>obj.get_è”è¡¨å_display</code>è·å–åˆ°å’Œåç«¯<code>get_è”è¡¨å_display()</code>çš„æ•ˆæœï¼Œç›´æ¥è¿”å›å¯¹ç…§è¿‡åçš„ç»“æœè€Œä¸æ˜¯å¯¹åº”çš„å…³è”idã€‚</a></li>
<li><a href="#17django%E7%9A%84%E6%A8%A1%E6%9D%BF%E5%8F%AF%E4%BB%A5%E8%BF%9B%E8%A1%8C%E7%9A%84%E9%A2%9D%E5%A4%96%E6%93%8D%E4%BD%9C">17.djangoçš„æ¨¡æ¿å¯ä»¥è¿›è¡Œçš„é¢å¤–æ“ä½œï¼š</a></li>
<li><a href="#18modelform%E7%9A%84%E5%AD%97%E6%AE%B5%E6%A0%A1%E9%AA%8C%E5%87%BD%E6%95%B0">18.modelformçš„å­—æ®µæ ¡éªŒå‡½æ•°</a></li>
<li><a href="#19%E8%B0%83%E6%95%B4%E8%BF%94%E5%9B%9E%E7%9A%84%E6%8F%90%E7%A4%BA%E4%BF%A1%E6%81%AF%E4%B8%BA%E6%B1%89%E8%AF%AD">19.è°ƒæ•´è¿”å›çš„æç¤ºä¿¡æ¯ä¸ºæ±‰è¯­</a></li>
<li><a href="#20modelform%E4%B8%ADinstance%E5%8F%82%E6%95%B0">20.modelformä¸­<code>instance</code>å‚æ•°</a></li>
<li><a href="#21django%E6%9F%A5%E8%AF%A2%E6%8E%92%E5%BA%8F">21.djangoæŸ¥è¯¢æ’åº</a></li>
<li><a href="#22%E7%BB%99%E5%8E%9F%E6%9C%89%E7%9A%84%E8%A1%A8%E4%B8%AD%E6%B7%BB%E5%8A%A0%E6%96%B0%E7%9A%84%E5%AD%97%E6%AE%B5%E4%BA%A7%E7%94%9F%E9%94%99%E8%AF%AFdjangocoreexceptionsvalidationerror-error">22.ç»™åŸæœ‰çš„è¡¨ä¸­æ·»åŠ æ–°çš„å­—æ®µäº§ç”Ÿé”™è¯¯<code>&quot;django.core.exceptions.ValidationError&quot; error</code></a></li>
<li><a href="#23django%E6%8A%A5%E9%94%99orderform-object-has-no-attribute-get">23.djangoæŠ¥é”™<code>'orderForm' object has no attribute 'get'</code></a></li>
<li><a href="#24%E5%85%B3%E9%97%AD%E6%B5%8F%E8%A7%88%E5%99%A8%E6%A0%A1%E9%AA%8C">24.å…³é—­æµè§ˆå™¨æ ¡éªŒ</a></li>
<li><a href="#25%E5%85%B3%E4%BA%8Emodels%E4%B8%ADnull%E5%92%8Cblack%E5%AD%97%E6%AE%B5">25.å…³äºmodelsä¸­nullå’Œblackå­—æ®µ</a></li>
<li><a href="#26modelforms%E4%BE%BF%E6%8D%B7%E5%86%99%E6%B3%95">26.modelformsä¾¿æ·å†™æ³•</a></li>
<li><a href="#27%E5%90%8E%E7%AB%AF%E8%A1%A8%E5%8D%95%E6%AD%A3%E5%88%99%E6%A0%A1%E9%AA%8C">27.åç«¯è¡¨å•æ­£åˆ™æ ¡éªŒ</a></li>
<li><a href="#28%E9%92%A9%E5%AD%90%E6%96%B9%E6%B3%95%E8%BF%9B%E8%A1%8C%E5%AD%97%E6%AE%B5%E6%A0%A1%E9%AA%8C">28.é’©å­æ–¹æ³•è¿›è¡Œå­—æ®µæ ¡éªŒ</a></li>
<li><a href="#29%E8%A7%84%E5%AE%9Amodelform%E4%B8%AD%E4%B8%8D%E5%8F%AF%E7%BC%96%E8%BE%91%E7%9A%84%E9%83%A8%E5%88%86">29.è§„å®šmodelformä¸­ä¸å¯ç¼–è¾‘çš„éƒ¨åˆ†</a></li>
<li><a href="#30%E9%80%9A%E8%BF%87modelform%E5%88%A4%E6%96%AD%E8%A6%81%E6%B7%BB%E5%8A%A0%E7%9A%84%E6%95%B0%E6%8D%AE%E6%98%AF%E5%90%A6%E9%87%8D%E5%A4%8D">30.é€šè¿‡modelformåˆ¤æ–­è¦æ·»åŠ çš„æ•°æ®æ˜¯å¦é‡å¤</a></li>
<li><a href="#31%E6%9F%A5%E8%AF%A2%E6%A0%B9%E6%8D%AE%E6%9F%90%E4%B8%AA%E5%AD%97%E7%9A%84%E4%B8%80%E9%83%A8%E5%88%86%E8%BF%9B%E8%A1%8C">31.æŸ¥è¯¢ï¼ˆæ ¹æ®æŸä¸ªå­—çš„ä¸€éƒ¨åˆ†è¿›è¡Œï¼‰</a></li>
<li><a href="#32%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95modelform%E4%B8%8D%E8%83%BD%E6%9B%B4%E6%96%B0%E4%B8%80%E8%A1%8C%E6%95%B0%E6%8D%AE%E7%9A%84%E9%83%A8%E5%88%86%E5%AD%97%E6%AE%B5">32.é—®é¢˜è®°å½•ï¼šmodelformä¸èƒ½æ›´æ–°ä¸€è¡Œæ•°æ®çš„éƒ¨åˆ†å­—æ®µ</a></li>
<li><a href="#33django%E7%9A%84%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2">33.djangoçš„æ¡ä»¶æŸ¥è¯¢</a></li>
<li><a href="#34%E8%AE%BE%E7%BD%AEget%E9%BB%98%E8%AE%A4%E5%80%BC">34.è®¾ç½®geté»˜è®¤å€¼</a></li>
</ul>
</li>
</ul>
</li>
</ul>

              </div>
            </div>
          </article>
        </div>

        
          <div class="next-post">
            <div class="next">ä¸‹ä¸€ç¯‡</div>
            <a href="http://localhost:4000/post/extra-details-of-python-for-long-term-part2/">
              <h3 class="post-title">
                Extra details of python - for long term - part.2
              </h3>
            </a>
          </div>
        

        

        <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
  <a class="rss" href="http://localhost:4000/atom.xml" target="_blank">
    <i class="ri-rss-line"></i> RSS
  </a>
</div>

      </div>
    </div>

    <script>
      hljs.initHighlightingOnLoad()

      let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

      // This should probably be throttled.
      // Especially because it triggers during smooth scrolling.
      // https://lodash.com/docs/4.17.10#throttle
      // You could do like...
      // window.addEventListener("scroll", () => {
      //    _.throttle(doThatStuff, 100);
      // });
      // Only not doing it here to keep this Pen dependency-free.

      window.addEventListener("scroll", event => {
        let fromTop = window.scrollY;

        mainNavLinks.forEach((link, index) => {
          let section = document.getElementById(decodeURI(link.hash).substring(1));
          let nextSection = null
          if (mainNavLinks[index + 1]) {
            nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
          }
          if (section.offsetTop <= fromTop) {
            if (nextSection) {
              if (nextSection.offsetTop > fromTop) {
                link.classList.add("current");
              } else {
                link.classList.remove("current");    
              }
            } else {
              link.classList.add("current");
            }
          } else {
            link.classList.remove("current");
          }
        });
      });

    </script>
  </body>
</html>
