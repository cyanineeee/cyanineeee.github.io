<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Upload files by Django(Part.1--without Models, Forms, ModelForm) | cyanine</title>
<link rel="shortcut icon" href="https://cyanineeee.github.io/favicon.ico?v=1727687297417">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://cyanineeee.github.io/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="Upload files by Django(Part.1--without Models, Forms, ModelForm) | cyanine - Atom Feed" href="https://cyanineeee.github.io/atom.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">



    <meta name="description" content="Djangoä¸Šä¼ æ–‡ä»¶(Part.1)
è¿™å‡ å¤©ä¸€ç›´å› ä¸ºè¿™ä¸ªé—®é¢˜æ£é¼“äº†åŠå¤©ï¼Œå„ç§é—®é¢˜éƒ½å‡ºæ¥äº†ã€‚å› ä¸ºå¤ªå¤šäº†è€Œä¸”æœ€åä¹Ÿè§£å†³çš„ï¼Œäºæ˜¯å°±åªå†™ä¸€ä¸ªæœ€åæ€»ç»“å‡ºæ¥çš„æ–¹æ³•å§ã€‚è€Œä¸”å› ä¸ºé—®é¢˜å¤ªå¤šï¼Œå°±æŠŠå†™çš„æ—¶å€™èƒ½æƒ³åˆ°çš„é‡åˆ°çš„é—®é¢˜é¡ºä¾¿å°±åˆ—å‡ºæ¥ã€‚
åªæ¼”ç¤ºä¸Šä¼ æ–‡ä»¶è¿™ä¸€å•ä¸€..." />
    <meta name="keywords" content="Django,python" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
    <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.5.1/build/highlight.min.js"></script>
  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://cyanineeee.github.io">
  <img class="avatar" src="https://cyanineeee.github.io/images/avatar.png?v=1727687297417" alt="">
  </a>
  <h1 class="site-title">
    cyanine
  </h1>
  <p class="site-description">
    my personal blog
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          Home Page
        </a>
      
    
      
        <a href="/archives" class="menu">
          Archive
        </a>
      
    
      
        <a href="/tags" class="menu">
          Tags
        </a>
      
    
      
        <a href="/post/about" class="menu">
          About
        </a>
      
    
  </div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              Upload files by Django(Part.1--without Models, Forms, ModelForm)
            </h2>
            <div class="post-info">
              <span>
                2022-10-05
              </span>
              <span>
                5 min read
              </span>
              
                <a href="https://cyanineeee.github.io/tag/M8-hjmU6C/" class="post-tag">
                  # Django
                </a>
              
                <a href="https://cyanineeee.github.io/tag/axGgidGI4/" class="post-tag">
                  # python
                </a>
              
            </div>
            
            <div class="post-content-wrapper">
              <div class="post-content" v-pre>
                <h1 id="djangoä¸Šä¼ æ–‡ä»¶part1">Djangoä¸Šä¼ æ–‡ä»¶(Part.1)</h1>
<p>è¿™å‡ å¤©ä¸€ç›´å› ä¸ºè¿™ä¸ªé—®é¢˜æ£é¼“äº†åŠå¤©ï¼Œå„ç§é—®é¢˜éƒ½å‡ºæ¥äº†ã€‚å› ä¸ºå¤ªå¤šäº†è€Œä¸”æœ€åä¹Ÿè§£å†³çš„ï¼Œäºæ˜¯å°±åªå†™ä¸€ä¸ªæœ€åæ€»ç»“å‡ºæ¥çš„æ–¹æ³•å§ã€‚è€Œä¸”å› ä¸ºé—®é¢˜å¤ªå¤šï¼Œå°±æŠŠå†™çš„æ—¶å€™èƒ½æƒ³åˆ°çš„é‡åˆ°çš„é—®é¢˜é¡ºä¾¿å°±åˆ—å‡ºæ¥ã€‚</p>
<p>åªæ¼”ç¤ºä¸Šä¼ æ–‡ä»¶è¿™ä¸€å•ä¸€åŠŸèƒ½ï¼Œæ‰€ä»¥å°±æ–°å»ºä¸€ä¸ªé¡¹ç›®ï¼Œä¸€è¾¹åšä¸€è¾¹è®°å½•ä¸‹æ¥ã€‚</p>
<p>Ps.åœ¨windowsç³»ç»Ÿä¸‹</p>
<h3 id="ä¸ä½¿ç”¨modelså’Œformsè¿›è¡Œä¸Šä¼ è‡ªå®šä¹‰ä¸Šä¼ æ–‡ä»¶å›¾ç‰‡">ä¸ä½¿ç”¨modelså’Œformsè¿›è¡Œä¸Šä¼ ï¼ˆè‡ªå®šä¹‰ä¸Šä¼ æ–‡ä»¶/å›¾ç‰‡ï¼‰</h3>
<p>éœ€æ±‚ï¼šæœ€ç»ˆåˆ›å»ºä¸¤ä¸ªé¡µé¢ï¼Œä¸€ä¸ªæ˜¯ä¸Šä¼ ä¸»é¡µé¢ï¼Œä¸€ä¸ªæ˜¯ä¸Šä¼ ç»“æœé¡µé¢ï¼Œç»“æœé¡µé¢åˆ†ä¸ºä¸Šä¼ æˆåŠŸå’Œä¸Šä¼ å¤±è´¥ï¼Œä¸¤ä¸ªç»“æœé¡µé¢éƒ½å¯ä»¥å†æ¬¡ç»§ç»­ä¸Šä¼ ã€‚ä¸Šä¼ çš„æ–‡ä»¶ä¿å­˜åœ¨ä¸manage.pyå­˜åœ¨ç›®å½•ä¸‹çš„media/uploadæ–‡ä»¶å¤¹å†…ã€‚</p>
<ol>
<li>æ–°å»ºé¡¹ç›®temptation,å¹¶æ–°å»ºappã€‚åœ¨æœ‰djangoç¯å¢ƒä¸‹çš„windowså‘½ä»¤çª—å£ä¸­è¾“å…¥<br>
<code>django-admin startproject temptation</code><br>
<code>python manage.py startapp upload</code><br>
ç”Ÿæˆçš„é¡¹ç›®ç»“æ„ï¼š</li>
</ol>
<blockquote>
<pre><code>D:temptation
â”‚  manage.py
â”‚
â”œâ”€temptationâ”‚  â”‚  asgi.py
â”‚  â”‚  settings.py
â”‚  â”‚  urls.py
â”‚  â”‚  wsgi.py
â”‚  â”‚  __init__.py
â”‚  â”‚
â”‚  â””â”€__pycache__
â”‚          settings.cpython-39.pyc
â”‚          __init__.cpython-39.pyc
â”‚
â””â”€upload
   â”‚  admin.py
   â”‚  apps.py
   â”‚  models.py
   â”‚  tests.py
   â”‚  views.py
   â”‚  __init__.py
   â”‚
   â””â”€migrations
           __init__.py
</code></pre>
</blockquote>
<ol start="2">
<li>ç„¶ååœ¨temptation/settings.pyä¸­</li>
</ol>
<blockquote>
<pre><code>INSTALLED_APPS = [
   &quot;django.contrib.admin&quot;,
		......
	 'upload',//æ·»åŠ 
</code></pre>
</blockquote>
<p>Ps. æ­¤æ—¶ä¸å¯¹TEMPALTESä¸­çš„DIRSè¿›è¡Œé…ç½®ï¼Œè¿™æ ·åœ¨ä¹‹åé…ç½®htmlæ–‡ä»¶æ—¶å°±å¯ä»¥ç›´æ¥åœ¨uploadä¸‹åˆ›å»ºtemplatesæ–‡ä»¶å¤¹ï¼Œç„¶åç›´æ¥å°†htmlæ–‡ä»¶æ”¾å…¥ã€‚å› ä¸ºä¸å¯¹è·¯å¾„è¿›è¡Œé…ç½®djangoä¼šå…ˆå¯»æ‰¾manage.pyæ‰€åœ¨çš„æ–‡ä»¶å¤¹ä¸­æ˜¯å¦æœ‰templatesæ–‡ä»¶å¤¹ï¼Œç„¶åå†åœ¨æ¯ä¸ªappä¸‹å¯»æ‰¾templatesæ–‡ä»¶å¤¹ï¼Œç›´åˆ°æ‰¾åˆ°ä¸ºæ­¢ã€‚<br>
3. temptation/urls.pyä¸­:</p>
<blockquote>
<pre><code>from django.contrib import admin
from django.urls import path,include//æ·»åŠ 

urlpatterns = [
  path(&quot;admin/&quot;, admin.site.urls),
   path(&quot;upload/&quot;, include('upload.urls')),//æ·»åŠ 
]
</code></pre>
</blockquote>
<ol start="4">
<li>åœ¨uploadæ–‡ä»¶ä¸­åˆ›å»ºurls.pyæ–‡ä»¶ï¼Œå¹¶é…ç½®ï¼š</li>
</ol>
<blockquote>
<pre><code>from django.urls import path
from . import views

urlpatterns = [
   path('index/',views.index,name='index'),
   path('result/',views.result,name='result')
]
</code></pre>
</blockquote>
<ol start="5">
<li>å¡«å†™è§†å›¾æ–¹æ³•</li>
</ol>
<blockquote>
<pre><code>from django.shortcuts import render
def index(request):    //é…ç½®åŸºç¡€é¡µé¢ 
   return render(request,'index.html')

def result(request):
   if request.method == &quot;POST&quot;: 
       file = request.FILES['file']
       filename = file.name
       filepath = &quot;media/upload/&quot; + filename  //åˆ›å»ºæ–‡ä»¶ä¿å­˜è·¯å¾„ï¼Œæ˜¯ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼Œç›¸å¯¹äºmanage.pyæ‰€åœ¨çš„æ–‡ä»¶å¤¹
       with open(filepath,'wb+') as f:  //å†™å…¥æ–‡ä»¶
           for chunk in file.chunks():  //åˆ†å—å†™å…¥æ–‡ä»¶ï¼Œé¿å…æ–‡ä»¶å¤ªå¤§å æ»¡å†…å­˜
               f.write(chunk)
           f.close()
       return render(request,'result.html',{'result':'ä¸Šä¼ æ–‡ä»¶æˆåŠŸï¼'})
   else:
       return render(request,'result.html',{&quot;result&quot;:'ä¸Šä¼ æ–‡ä»¶å¤±è´¥ï¼'})
</code></pre>
</blockquote>
<ol start="6">
<li>åˆ›å»ºtemplatesæ–‡ä»¶å¤¹ï¼Œå¹¶åˆ›å»ºindex.htmlå’Œresult.htmlé¡µé¢<br>
index.html</li>
</ol>
<blockquote>
<pre><code>&lt;form name=&quot;show&quot; action=&quot;{% url 'result'%}&quot; method=&quot;POST&quot; enctype =&quot;multipart/form-data&quot;&gt;   /*åˆ›å»ºformè¡¨å•*/
/*actionè¡¨ç¤ºè¡¨å•ä¸Šä¼ è‡³result.htmlé¡µé¢ï¼Œå¦‚æœactionä¸ºç©ºé‚£ä¹ˆä¸ä¼šæœ‰é¡µé¢è½¬è·³ï¼Œæ–‡ä»¶ä¹Ÿä¸Šä¼ å¤±è´¥ã€‚*/
   {% csrf_token %}   /*djangoå†…ç½®çš„ä¸Šä¼ ç”¨æˆ·å®¡æŸ¥ï¼Œç›®å‰åªéœ€è¦è®°ä½ä¸Šä¼ æ–‡ä»¶çš„æ—¶å€™è¦åŠ ä¸Š*/
   &lt;label for=&quot;fileupload&quot; &gt;è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶&lt;/label&gt;  /*forå±æ€§è¡¨ç¤ºå°†labelæ ‡ç­¾å’Œidä¸ºfileuploadçš„inputæ ‡ç­¾å…³è”*/
   &lt;input type=&quot;file&quot; name=&quot;file&quot; id=&quot;fileupload&quot;&gt;
   &lt;input type=&quot;submit&quot; value=&quot;ä¸Šä¼ &quot;&gt;
&lt;/form&gt;
{% block result%}  /*djangoçš„ç»§æ‰¿æ¨¡æ¿ï¼Œç”¨äºåšå‡ºç±»ä¼¼äºä¸åˆ·æ–°é¡µé¢è¿”å›ç»“æœçš„æ•ˆæœ*/
{%endblock%}
</code></pre>
</blockquote>
<p>result.html</p>
<blockquote>
<pre><code>{% extends 'index.html' %}   /*ç»§æ‰¿index.htmlæ¨¡æ¿*/

{% block result%}
{{result}}   /*æ˜¾ç¤ºä¸Šä¼ ç»“æœ*/
{%endblock%}
</code></pre>
</blockquote>
<ol start="7">
<li>åˆ°æ­¤ç»“æŸï¼Œåˆ—ä¸¾ä¸€ä¸‹æœ€åçš„é¡¹ç›®ç»“æ„</li>
</ol>
<blockquote>
<pre><code>D:temptation
â”‚  db.sqlite3
â”‚  manage.py
â”‚
â”œâ”€media
â”‚  â””â”€upload
â”‚          img401.png
â”‚          img402.png
â”‚
â”œâ”€temptation
â”‚  â”‚  asgi.py
â”‚  â”‚  settings.py
â”‚  â”‚  urls.py
â”‚  â”‚  wsgi.py
â”‚  â”‚  __init__.py
â”‚  â”‚
â”‚  â””â”€__pycache__
â”‚          settings.cpython-39.pyc
â”‚          urls.cpython-39.pyc
â”‚          wsgi.cpython-39.pyc
â”‚          __init__.cpython-39.pyc
â”‚
â””â”€upload
   â”‚  admin.py
   â”‚  apps.py
   â”‚  models.py
   â”‚  tests.py
   â”‚  urls.py
   â”‚  views.py
   â”‚  __init__.py
   â”‚
   â”œâ”€migrations
   â”‚  â”‚  __init__.py
   â”‚  â”‚
   â”‚  â””â”€__pycache__
   â”‚          __init__.cpython-39.pyc
   â”‚
   â”œâ”€templates
   â”‚      index.html
   â”‚      result.html
   â”‚
   â””â”€__pycache__
           admin.cpython-39.pyc
           apps.cpython-39.pyc
           models.cpython-39.pyc
           urls.cpython-39.pyc
           views.cpython-39.pyc
           __init__.cpython-39.pyc
</code></pre>
</blockquote>
<p>è¯„ä»·ï¼šè¿™ç§æ–¹æ³•æœ€ç®€å•ï¼Œä¸éœ€è¦å¾ˆå¤šå…¶ä»–çš„é…ç½®ï¼Œæ–‡ä»¶è·¯å¾„å’Œåå­—ä¹Ÿéƒ½å¯ä»¥è‡ªå®šä¹‰ï¼ˆæ¯”å¦‚æ¢æˆä¸Šä¼ æ—¶é—´ï¼‰ã€‚ä½†æ˜¯ç¼ºå°‘å¯¹ä¸Šä¼ æ–‡ä»¶æ ¼å¼çš„åˆ¤æ–­ã€å¯¹è¡¨å•ä¼ æ¥æ•°æ®çš„å®¡æŸ¥ã€æ²¡æœ‰å­˜å‚¨åˆ°æ•°æ®åº“ä¸æ–¹ä¾¿ç®¡ç†ç­‰ã€‚<br>
Ps. è¿™ä¸ªé¡¹ç›®å®Œå…¨å¯ä»¥ä¸ç”¨åˆ›å»ºæ•°æ®åº“ï¼ˆä¹Ÿå°±æ˜¯ä½¿ç”¨<code>python manage.py makemigrations</code>å’Œ<code>python manage.py migrate</code>ï¼‰ï¼Œä½†æ˜¯å¼ºè¿«ç—‡å¿ä¸äº†çº¢è‰²çš„æç¤ºğŸ˜³</p>

              </div>
              <div class="toc-container">
                <ul class="markdownIt-TOC">
<li><a href="#django%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6part1">Djangoä¸Šä¼ æ–‡ä»¶(Part.1)</a><br>
*
<ul>
<li><a href="#%E4%B8%8D%E4%BD%BF%E7%94%A8models%E5%92%8Cforms%E8%BF%9B%E8%A1%8C%E4%B8%8A%E4%BC%A0%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6%E5%9B%BE%E7%89%87">ä¸ä½¿ç”¨modelså’Œformsè¿›è¡Œä¸Šä¼ ï¼ˆè‡ªå®šä¹‰ä¸Šä¼ æ–‡ä»¶/å›¾ç‰‡ï¼‰</a></li>
</ul>
</li>
</ul>

              </div>
            </div>
          </article>
        </div>

        
          <div class="next-post">
            <div class="next">ä¸‹ä¸€ç¯‡</div>
            <a href="https://cyanineeee.github.io/post/the-import-system-of-python/">
              <h3 class="post-title">
                The import system of python 
              </h3>
            </a>
          </div>
        

        

        <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
  <a class="rss" href="https://cyanineeee.github.io/atom.xml" target="_blank">
    <i class="ri-rss-line"></i> RSS
  </a>
</div>

      </div>
    </div>

    <script>
      hljs.initHighlightingOnLoad()

      let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

      // This should probably be throttled.
      // Especially because it triggers during smooth scrolling.
      // https://lodash.com/docs/4.17.10#throttle
      // You could do like...
      // window.addEventListener("scroll", () => {
      //    _.throttle(doThatStuff, 100);
      // });
      // Only not doing it here to keep this Pen dependency-free.

      window.addEventListener("scroll", event => {
        let fromTop = window.scrollY;

        mainNavLinks.forEach((link, index) => {
          let section = document.getElementById(decodeURI(link.hash).substring(1));
          let nextSection = null
          if (mainNavLinks[index + 1]) {
            nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
          }
          if (section.offsetTop <= fromTop) {
            if (nextSection) {
              if (nextSection.offsetTop > fromTop) {
                link.classList.add("current");
              } else {
                link.classList.remove("current");    
              }
            } else {
              link.classList.add("current");
            }
          } else {
            link.classList.remove("current");
          }
        });
      });

    </script>
  </body>
</html>
